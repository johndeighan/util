import {
	getMyCaller, getMyOutsideCaller, TStackFrame,
	} from 'v8-stack'

type TBothFrames = [TStackFrame?, TStackFrame?]

export getBoth := (): TBothFrames =>

	result := secondFunc 'both'
	if Array.isArray(result)
		return result
	else
		throw new Error "Expected array, got TStackFrame"

export getDirect := (): TStackFrame? =>

	result := secondFunc 'direct'
	if Array.isArray(result)
		throw new Error "Got unexpected array"
	return result

export getOutside := (): TStackFrame? =>

	result := secondFunc 'outside'
	if Array.isArray(result)
		throw new Error "Got unexpected array"
	return result

secondFunc := (type: string): TBothFrames | TStackFrame? =>

	return thirdFunc type

thirdFunc := (type: string): TBothFrames | TStackFrame? =>

	switch type
		when 'both'
			return [getMyCaller(), getMyCaller()]
		when 'direct'
			return getMyCaller()
		when 'outside'
			return getMyOutsideCaller()
		else
			throw new Error "Unknown type: #{type}"